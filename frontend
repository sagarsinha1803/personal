src/
 â”œâ”€â”€ components/
 â”‚     â”œâ”€â”€ ChatMessage.js
 â”‚     â”œâ”€â”€ Loader.js
 â”‚     â”œâ”€â”€ ApprovalModal.js
 â”œâ”€â”€ App.js
 â”œâ”€â”€ api.js
 â””â”€â”€ index.css


ChatMessage.js

import React from "react";

export default function ChatMessage({ sender, text }) {
  const isUser = sender === "user";

  return (
    <div
      style={{
        display: "flex",
        justifyContent: isUser ? "flex-end" : "flex-start",
        marginBottom: "10px",
      }}
    >
      <div
        style={{
          maxWidth: "70%",
          padding: "12px 16px",
          borderRadius: "12px",
          background: isUser ? "#4f46e5" : "#e4e4e7",
          color: isUser ? "white" : "black",
          fontSize: "15px",
        }}
      >
        {text}
      </div>
    </div>
  );
}



Loader.js

import React from "react";
import "./loader.css";

export default function Loader() {
  return (
    <div className="typing-loader">
      <span></span><span></span><span></span>
    </div>
  );
}


loader.css

.typing-loader {
  display: flex;
  gap: 6px;
  margin: 10px 0;
}

.typing-loader span {
  width: 8px;
  height: 8px;
  background: #4f46e5;
  border-radius: 50%;
  animation: typing 0.7s infinite ease-in-out alternate;
}

.typing-loader span:nth-child(2) {
  animation-delay: 0.2s;
}

.typing-loader span:nth-child(3) {
  animation-delay: 0.4s;
}

@keyframes typing {
  from { transform: translateY(0); opacity: 0.5; }
  to { transform: translateY(-6px); opacity: 1; }
}




ApprovalModal.js


import React, { useState } from "react";

export default function ApprovalModal({ open, interrupt, onAction }) {
  const [updateText, setUpdateText] = useState("");

  if (!open) return null;

  return (
    <div style={styles.container}>
      <div style={styles.card}>
        <h3 style={styles.title}>âš  Human Approval Required</h3>

        <p style={styles.text}>
          The model wants to run this tool:
        </p>

        <pre style={styles.code}>
{JSON.stringify(interrupt.tool_call, null, 2)}
        </pre>

        <div style={{ marginTop: 15 }}>
          <button style={styles.btnContinue} onClick={() => onAction("continue", null)}>
            âœ” Continue
          </button>

          <textarea
            placeholder="Enter updated arguments (JSON)"
            style={styles.textarea}
            value={updateText}
            onChange={(e) => setUpdateText(e.target.value)}
          />

          <button style={styles.btnUpdate} onClick={() => onAction("update", updateText)}>
            ğŸ”„ Update Arguments
          </button>

          <button style={styles.btnReject} onClick={() => onAction("feedback", "Rejected by user")}>
            âŒ Reject
          </button>
        </div>
      </div>
    </div>
  );
}

const styles = {
  container: {
    position: "fixed", top: 0, left: 0, right: 0, bottom: 0,
    background: "rgba(0,0,0,0.3)",
    display: "flex", justifyContent: "center", alignItems: "center",
    zIndex: 1000,
  },
  card: {
    background: "white",
    width: 450,
    padding: 20,
    borderRadius: 12,
    boxShadow: "0 4px 15px rgba(0,0,0,0.2)",
  },
  title: { margin: 0, marginBottom: 10 },
  text: { fontSize: 14 },
  code: {
    background: "#f4f4f5",
    padding: 10,
    borderRadius: 8,
    fontSize: 13,
    overflowX: "auto",
  },
  textarea: {
    width: "100%", height: 70,
    marginTop: 8, padding: 8,
    borderRadius: 6, border: "1px solid #ccc",
  },
  btnContinue: {
    width: "100%", padding: 10, background: "#22c55e",
    border: "none", borderRadius: 8, color: "white",
    fontSize: 15, cursor: "pointer", marginBottom: 8,
  },
  btnUpdate: {
    width: "100%", padding: 10, background: "#3b82f6",
    borderRadius: 8, color: "white", border: "none",
    fontSize: 15, cursor: "pointer", marginTop: 8,
  },
  btnReject: {
    width: "100%", padding: 10, background: "#ef4444",
    borderRadius: 8, color: "white", border: "none",
    fontSize: 15, cursor: "pointer", marginTop: 8,
  },
};





App.js

import React, { useState, useRef } from "react";
import ChatMessage from "./components/ChatMessage";
import Loader from "./components/Loader";
import ApprovalModal from "./components/ApprovalModal";

function App() {
  const [messages, setMessages] = useState([]);
  const [loading, setLoading] = useState(false);
  const [interrupt, setInterrupt] = useState(null);

  const checkpoint = useRef(null);

  const sendMessage = async (text) => {
    setMessages((m) => [...m, { sender: "user", text }]);
    setLoading(true);

    const response = new EventSource("http://localhost:8000/agent/chat_stream?message=" + encodeURIComponent(text));

    response.onmessage = (event) => {
      const data = JSON.parse(event.data);

      if (data.type === "human_approval_required") {
        checkpoint.current = data.checkpoint_id;
        setInterrupt(data.interrupt);
        response.close();
        setLoading(false);
        return;
      }

      if (data.type === "ai_response") {
        setMessages((m) => [...m, { sender: "ai", text: data.text }]);
      }
    };

    response.onerror = () => {
      response.close();
      setLoading(false);
    };
  };

  const handleAction = async (action, data) => {
    setInterrupt(null);
    setLoading(true);

    const res = await fetch("http://localhost:8000/agent/resume_stream", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        checkpoint_id: checkpoint.current,
        action,
        data,
      }),
    });

    const stream = new EventSource("http://localhost:8000/agent/resume_stream_sse?checkpoint_id=" + checkpoint.current);

    stream.onmessage = (event) => {
      const data = JSON.parse(event.data);

      if (data.type === "ai_response") {
        setMessages((m) => [...m, { sender: "ai", text: data.text }]);
        setLoading(false);
      }
    };
  };

  return (
    <div style={{ padding: 20, width: 600, margin: "auto" }}>
      <h2>AI Assistant</h2>

      <div style={{ height: 450, overflowY: "auto", border: "1px solid #ddd", padding: 12, borderRadius: 8 }}>
        {messages.map((msg, i) => (
          <ChatMessage key={i} sender={msg.sender} text={msg.text} />
        ))}

        {loading && <Loader />}
      </div>

      <input
        type="text"
        placeholder="Type a message..."
        style={{ width: "100%", padding: 12, marginTop: 10 }}
        onKeyDown={(e) => e.key === "Enter" && sendMessage(e.target.value)}
      />

      <ApprovalModal open={!!interrupt} interrupt={interrupt} onAction={handleAction} />
    </div>
  );
}

export default App;
